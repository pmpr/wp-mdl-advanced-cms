(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=jQuery;var o=e.n(t);function n(e,t){return`<a style="color: #075fa9" data-name="${e}" class="shortcode-edit-link">${t}</a>`}let i="";var r;r=window.tinymce,PMPRTrigger.addFilter("shortcode_construct",(function(e,t){return n(t,e)})),r.ui.Factory.add("ShortcodePreview",r.ui.Control.extend({id:"",tag:"",group:"",attributes:{},renderHtml:function(){return`<div id="${this._id}" class="wp-link-preview shortcode-preview">${this.tag}</div>`}})),r.PluginManager.add("shortcode",(function(e){let t,c,a=PMPRUtil.getSettingByPath("shortcode.names");function d(e=!0){t.hide(),e&&(i=null)}function s(){let t=e.getContent();a&&t&&l(t)&&(t=wp.shortcode.replace(a,t,(function(e){let t=e.attrs.named,i=e.tag,r=e.content||"";return PMPRUtil.isEmpty(r)&&(o().each(t,(function(e,t){r+=`${e}="${t}" `})),r=`[${i} ${r.trim()}]`),n(i,r)})),t&&e.setContent(t))}function l(e){return!PMPRUtil.isEmpty(e.match(wp.shortcode.regexp(a)))}function u(e){let t='class="shortcode-edit-link"';return e.replace(/(<a [^>]+>)([\s\S]*?)<\/a>/g,(function(e,o,n){return(e.indexOf(t)>-1||o.indexOf(t)>-1)&&(e=n),e}))}return PMPRUtil.isEmpty(a)||(a=a.join("|"),e.on("init",(function(){t&&s()})),e.on("preinit",(function(){e.wp&&e.wp._createToolbar&&(t=e.wp._createToolbar(["shortcode_edit","shortcode_remove"],!0))})),e.on("keydown",(function(t){27===t.keyCode&&e.execCommand("shortcode_cancel")})),e.on("wptoolbar",(function(n){!i||t.state.data.visible&&t.state.data.active||d(!1);let r=o()(e.dom.getParent(n.element,"a.shortcode-edit-link"));r.length>0&&(i=r,n.toolbar=t);let c=e.getContent(),a=o()(e.dom.doc).find("a.shortcode-edit-link");l(c)&&PMPRUtil.isEmpty(a)&&s()})),e.on("savecontent",(function(e){e.content=u(e.content)})),e.on("BeforeAddUndo",(function(e){e.lastLevel&&e.lastLevel.content&&e.level.content&&e.lastLevel.content===u(e.level.content)&&e.preventDefault()})),e.on("after_insert_shortcode",(function(t){e.execCommand("shortcode_inserted"),i=null})),e.on("before_insert_shortcode",(function(e){i&&(i.replaceWith(""),d())})),e.addCommand("shortcode_edit",(function(e){if(i){let e=i.data("name"),t=function(e){let t,o={};return t=e.match(/[\w-]+=".+?"/g),PMPRUtil.isEmpty(t)||t.forEach((function(e){e=e.match(/([\w-]+)="(.+?)"/),o[e[1]]=PMPRUtil.unescape(e[2])})),o}(i.text()),n=o()(`#pr_ffm_modal_menu_${e}`);if(!PMPRUtil.isEmpty(e)){let c=n.closest(".pr-ffm-modal-container");PMPRUtil.isEmpty(c)||(c.addClass("show"),o()("body").addClass("modal-open"),n.trigger("click"),function(e,t){o().each(e,(function(e,n){let i=`${t}_${e}`,c=o()(`#${i}`);switch(PMPRUtil.isEmpty(c)&&(c=o()(`[name=${i}]`)),c.prop("nodeName").toLowerCase()){case"select":PMPRTrigger.doAction("populate_select2",c,n);break;case"input":switch(c.attr("type")){case"radio":c=c.filter(`input[value=${n}]`),c.prop("checked",!0);break;case"checkbox":c.prop("checked",!0);break;case"hidden":c.val(n).change();break;default:c.val(n)}break;case"textarea":if(c.is(".wp-editor-area")&&void 0!==r){let e=r.get(c.attr("id"));e&&e.setContent(n)}else c.val(n)}PMPRTrigger.doAction(`shortcode_${i}_changed`,c,n),c.trigger("change")}))}(t,e),i.addClass("editing"))}}})),e.addCommand("shortcode_cancel",(function(){t.hide(),d()})),e.addCommand("shortcode_remove",(function(){i&&(i.parent().replaceWith(""),d())})),e.addCommand("shortcode_inserted",(function(){t.scrolling||e.nodeChanged()})),e.addButton("shortcode_edit",{tooltip:"Edit Shortcode",icon:"dashicon dashicons-edit",cmd:"shortcode_edit"}),e.addButton("shortcode_preview",{type:"ShortcodePreview",onPostRender:function(){c=this}}),e.addButton("shortcode_remove",{tooltip:"Remove Shortcode",icon:"dashicon dashicons-trash",cmd:"shortcode_remove"})),{close:function(){console.log("closed.")}}}))})();