(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=jQuery;var n=e.n(t);function o(){let e=n()(".comments-list"),t=e.parent().find(".pr-spinner"),o=e.find(".alert");if(PMPRUtil.isEmpty(e))t.removeClass("show");else if(e.is(".done"))t.addClass("d-none");else{PMPRUtil.isEmpty(o)||o.parent().removeChild(o);let i=e.children().last();if(!e.is(".loading")&&(e.children.length<=0||!PMPRUtil.isEmpty(i)&&PMPRUtil.isInViewport(i))){let o=1,l="comment";i&&i.data("page")&&(o=parseInt(i.data("page"))+1),e.data("type")&&(l=e.getAttribute("type")),t.addClass("show"),e.addClass("loading");let s=PMPRUtil.getSettingByPath("comment.ajax.get_list"),c={page:o,type:l,post_id:PMPRUtil.getSettingByPath("post")};PMPRRequest.post(s,c).setSuccess((function(o){let i=o.result;PMPRUtil.isEmpty(i)||("object"==typeof i?i.forEach((function(t){let o=n()(t);o.hide(),e.append(o),o.slideDown("slow")})):"string"==typeof i&&e.append(i).hide().show("slow")),o.done&&e.addClass("done");try{let t=n()(".comments-container form #comment_parent").val();if(parseInt(t)>0){let t=e.find(".comment-reply-link");t&&[].forEach.call(t,(function(e){e.style.display="none"}))}}catch(e){console.log(e,"can not found comment parent")}e.removeClass("loading"),t.removeClass("show")})).addNonce().send()}}}n()(document).ready((function(){let e=n()("body");e.on("submit","#commentform",(function(e){e.preventDefault();let t=n()(this),o="",i=t.closest(".comment-respond").find(".show-form"),l=PMPRUtil.serializeForm(t);if(n().each(l,(function(e,t){let n="email"===e?e:"empty";if(!function(e,t){let n=!0;switch(t){case"name":case"comment":n=e.length>3;break;case"email":n=/^([\w-.]+@([\w-]+\.)+[\w-]{2,4})?$/.test(e)&&""!==e}return n}(t,e))return o=PMPRUtil.getSettingByPath(`comment.${n}_message`),!1})),PMPRUtil.isEmpty(o)){let e=PMPRUtil.getSettingByPath("comment.ajax.submit_form");PMPRRequest.post(e,l).setElement(t.find("#submit")).setMessageSelector("#comment_form_message").setContainer(n()(".comment-respond")).resetRecaptcha().setIsDisable(!0).setSuccess((function(e){t.find("textarea, input:text").val(""),PMPRUtil.notify("#comment_form_message",e,0),PMPRUtil.isEmpty(i)||i.trigger("click"),n()("#cancel-comment-reply-link").trigger("click")})).send()}else PMPRUtil.notify("#comment_form_message",o,0)})),e.on("click","#cancel-comment-reply-link",(function(e){e.preventDefault();let t,o=n()(this);t=o.closest(".comments-container"),t.find("form #comment_parent").val(0),t.find(".comment-reply-link").show(),PMPRUtil.isEmpty(o.closest(".comment-content"))?(o.hide(),t.find(".comments-list #cancel-comment-reply-link").remove()):(o.remove(),t.find("#cancel-comment-reply-link").hide())})),e.on("click",".comment-reply-link",(function(e){e.preventDefault();let t,o,i,l,s,c,m=n()(this);s=m.closest(".comments-container"),c=s.find("#cancel-comment-reply-link"),o=s.find("form"),i=m.closest(".comments-list"),i.find(".comment-reply-link").hide(),l=o.find("#comment_parent"),PMPRUtil.isEmpty(l)||(c.show(),t=m.data("commentid"),l.val(t),m.parent().append(c.clone()));let a=s.find(".show-form.collapsed");PMPRUtil.isEmpty(a)||a.trigger("click"),PMPRUtil.isEmpty(c)||c.get(0).scrollIntoView()}))})),n()(window).on("scroll",o),n()(document).on("DOMContentLoaded",o)})();